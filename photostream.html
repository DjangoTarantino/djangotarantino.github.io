<!DOCTYPE html>
<head>
  <title>>基础实验4</title>
  <meta charset="utf-8">
  <style type="text/css">
    body {
      background:#DDD;
      margin:0 
    }
    #workDemo {
      width:100%;
    }
    #workDemo a {
      margin:10px;
      padding:0;
      border:gray 5px solid;
      float:left;
      overflow:hidden;
      text-decoration:none; 
      display:block; 
      position:relative
    }
    #workDemo a:hover {
      border-color:white;
    }

  </style>
</head>


<div style = "position:relative; font-size:100px; font-family:Courier New;height:550px; top:150px; left: 200px;">Photo Stream
<p style = "font-size:50px;color:#6ff">Time you enjoy wasting, is not wasted.</p></div>
<div id="workDemo"style="z-index:1">
  <a href="#"><img src="http://djangotarantino.github.io/001.jpg" style="width:401px;height:303px" onerror="imgError()"/></a>
  <a href="#"><img src="http://djangotarantino.github.io/002.jpg" style="width:401px;height:303px" onerror="imgError()"/></a>
  <a href="#"><img src="http://djangotarantino.github.io/003.jpg" style="width:401px;height:303px" onerror="imgError()"/></a>
  <a href="#"><img src="http://djangotarantino.github.io/004.jpg" style="width:401px;height:303px" onerror="imgError()"/></a>
  <a href="#"><img src="http://djangotarantino.github.io/005.jpg" style="width:401px;height:303px" onerror="imgError()"/></a>
  <a href="#"><img src="http://djangotarantino.github.io/006.jpg" style="width:401px;height:303px" onerror="imgError()"/></a>
  <a href="#"><img src="http://djangotarantino.github.io/007.jpg" style="width:401px;height:303px" onerror="imgError()"/></a>
  <a href="#"><img src="http://djangotarantino.github.io/008.jpg" style="width:401px;height:303px" onerror="imgError()"/></a>
  <a href="#"><img src="http://djangotarantino.github.io/009.jpg" style="width:401px;height:303px" onerror="imgError()"/></a>
  <a href="#"><img src="http://djangotarantino.github.io/010.jpg" style="width:401px;height:303px" onerror="imgError()"/></a>
  <a href="#"><img src="http://djangotarantino.github.io/011.jpg" style="width:401px;height:303px" onerror="imgError()"/></a>
  <a href="#"><img src="http://djangotarantino.github.io/012.jpg" style="width:401px;height:303px" onerror="imgError()"/></a>
  <a href="#"><img src="http://djangotarantino.github.io/013.jpg" style="width:401px;height:303px" onerror="imgError()"/></a>
  <a href="#"><img src="http://djangotarantino.github.io/014.jpg" style="width:401px;height:303px" onerror="imgError()"/></a>
  <a href="#"><img src="http://djangotarantino.github.io/015.jpg" style="width:401px;height:303px" onerror="imgError()"/></a>
  <a href="#"><img src="http://djangotarantino.github.io/016.jpg" style="width:401px;height:303px" onerror="imgError()"/></a>
  <a href="#"><img src="http://djangotarantino.github.io/017.jpg" style="width:401px;height:303px" onerror="imgError()"/></a>
  <a href="#"><img src="http://djangotarantino.github.io/018.jpg" style="width:401px;height:303px" onerror="imgError()"/></a>
  <a href="#"><img src="http://djangotarantino.github.io/019.jpg" style="width:401px;height:303px" onerror="imgError()"/></a>
  <a href="#"><img src="http://djangotarantino.github.io/020.jpg" style="width:401px;height:303px" onerror="imgError()"/></a>
  <a href="#"><img src="http://djangotarantino.github.io/021.jpg" style="width:401px;height:303px" onerror="imgError()"/></a>
  <a href="#"><img src="http://djangotarantino.github.io/022.jpg" style="width:401px;height:303px" onerror="imgError()"/></a>
  <a href="#"><img src="http://djangotarantino.github.io/023.jpg" style="width:401px;height:303px" onerror="imgError()"/></a>
  <a href="#"><img src="http://djangotarantino.github.io/024.jpg" style="width:401px;height:303px" onerror="imgError()"/></a>
</div>

<div id="Layer1" style="position:fixed; left:0; top:0; width:100%; height:100%; z-index:-1">    
<img src="http://djangotarantino.github.io/345303.jpg" height="100%" width="100%"/> 
<script type="text/javascript" src="jquery-1.9.1.js"></script>
<script type="text/javascript">



  var cnt = 0;
  var isload = true;
  $(function(){
    $(window).scroll(function(){
      Load();
    });
  });
  function Load(){
    //ajax在后台获取数据时，设值其false，防止页面多次加载
    if(isload){
      //指定滚动条距离底部还有多少距离时进行数据加载
      var loadHeight = 200;
      //可视区域当前高度
      var documentHeight = parseInt($(document).height(),10);
      //窗口当前高度
      var windowHeight = parseInt($(window).height(),10);
      //窗口滚动条位置
      var scrollHight = parseInt($(window).scrollTop(),10);

      if(documentHeight - scrollHight - windowHeight < loadHeight){
        cnt++;
        //限定滚屏刷新次数 5
        if (cnt < 5) {
          isload = false;
          var html = loadurl();
          $("#workDemo").append(html);
          isload = true;
        };
        //调用事件绑定函数
        Eventattach();
      }
    }
  }
  
  //加载图片地址
  function loadurl(){
    var html = "";
    for(var i = 1; i < 25;i++){
      if (i < 10) {
        html =  html + "<a href='#'><img src='http://djangotarantino.github.io/00" + i + ".jpg' style='width:401px;height:303px' onerror='imgError()'/></a>";
      };
      if (i >= 10){
        html =  html + "<a href='#'><img src='http://djangotarantino.github.io/0" + i + ".jpg' style='width:401px;height:303px' onerror='imgError()'/></a>";
      };
      
    }
    return html;
  }




//错误加载提示
function imgError()
{
  alert('Certain image could not be loaded.');
}

function ImgShow(evt){


  var tagTop = Math.max(document.documentElement.scrollTop,document.body.scrollTop);
  //创建大图外部区域
  var tagoutside = document.createElement("div");
  //大图外部区域CSS
  tagoutside.style.cssText = "width:111%; height:"+ document.documentElement.scrollHeight +"px; position:absolute; background:black; top:0; filter:Alpha(Opacity=80); Opacity:0.8;";
  //双击大图外部区域：关闭大图
  tagoutside.ondblclick = closes;
  //创建大图标签区域
  var tagImg = document.createElement("div");
  //大图标签区域CSS
  tagImg.style.cssText = " overflow:left; text-align:center; position:absolute; width:200px; border:5px solid #FFF; background:white; left:"+(parseInt(document.body.offsetWidth) / 2 - 100)+"px; top:" + (document.documentElement.clientHeight/3 + tagTop) + "px;"
  //创建关闭标签
  var closeTag = document.createElement("div");
  //关闭标签CSS 内容
  closeTag.style.cssText="font:20px /25px Courier New;display:block; position:absolute; left:10px; top:10px; color:#000;";
  closeTag.innerHTML = "<b style='background:#DDD;border:1px solid white;filter:Alpha(Opacity=50);Opacity:0.5;cursor:pointer;'>&nbsp;Esc&nbsp</b>";

  //创建评论区域
  var comments = document.createElement("div");
  //评论区域CSS
  comments.style.cssText = "position:fixed; width:300px; border:5px solid #CCC; background:white; height:"+ document.documentElement.scrollHeight +"px;right:0; top:0;"
  //创建评论子区域
  var comTitle = document.createElement("div");
  comTitle.style.cssText = "font:30px /25px Courier New; position:absolute; width:95%; background:white; height:30px; text-align: center; top:20px;Alpha(Opacity=80);Opacity:0.8;cursor:crosshair;"
  comTitle.innerHTML = "<b style='border:1px solid black;background:#EEE;'>&nbsp;Comment List&nbsp;</b>";

  var comContent1 = document.createElement("div");
  comContent1.style.cssText = "font:20px /22px Courier New; position:absolute; width:99%; border:2px solid #000; background:white; height:"+ (document.documentElement.clientHeight/10 * 8) +"px;top:95px;";
  comContent1.innerHTML = "<p><br><li>无崖子：这是一张极其经典的照片，作为秀恩爱死得快的象征在民间广为流传。</li><br><li>有崖子：这张照片在一段时间内成为了中国销售第二的明信片。</li><br><li>有没有崖子：这幅照片是摄影史上的经典之作。</li><li>崖子：这幅照片形象的展示出为什么太阳是绿色的。</li><br><li>鸭子：这些照片我是见得多了。</li><br><li>实打实有鸭子：相比之下，其他照片还是图样啊。</li><br><li>没有鸭子：照照片，还是要按照照照片的基本法，不能乱来。</li><br><li>有没有鸭子：我当然资瓷了。</li><br><li>养鸭子：我是见得多了，</li><br><li>不养鸭子：那么问题来了：为什么所有的评论都一样？</li></p>";
  


  comments.appendChild(comTitle);
  comments.appendChild(comContent1);



  //单击关闭标签：关闭大图
  closeTag.onclick = closes;
  //添加入body子节点列
  document.body.appendChild(tagoutside);
  document.body.appendChild(tagImg);
  document.body.appendChild(comments);
  //创建图片对象img
  var img = new Image();
  //图片路径
  img.src = ((window.event) ? event.srcElement : evt.target).src;
  //图片CSS
  img.style.cssText = "cursor:pointer;";
  var barShow,imgTime;
  //图片是否加载成功
  img.complete ? ImgOK():(img.onload = ImgOK);
  //大图显示过程
  function ImgOK(){
    var Stop1 = false, Stop2 = false, temp = 0;
    var tx = tagImg.offsetWidth, ty = tagImg.offsetHeight;
    var ix = img.width, iy = img.height;
    var sx = document.documentElement.clientWidth, sy = window.innerHeight || document.documentElement.clientHeight;
    //若大图标签区域溢出浏览器
    if(ix >= sx || iy >= sy){
      var yy = sy - 100;
      var xx = (ix/iy) * yy;
    }
    else{
      var xx = ix;
      var yy = iy;
    }
    //确定图片尺寸
    img.style.width = xx + 'px';
    img.style.height = yy + 'px';


    //1ms频率刷新图片大小直到显示正确尺寸 即伪动画
    var maxTime = setInterval(function(){
      temp += 35;
      if((tx + temp) < xx){
        tagImg.style.width = (tx + temp) + "px";
        tagImg.style.left = (sx - (tx + temp)) / 2 + "px";
      }
      else{
        Stop1 = true;
        tagImg.style.width = xx + "px";
        tagImg.style.left = (sx - xx) / 2 + "px";
      }
      if((ty + temp) < yy){
        tagImg.style.height=(ty+temp)+"px";
        tagImg.style.top=(tagTop+((sy-(ty+temp))/2))+"px";
      }
      else{
        Stop2 = true;
        tagImg.style.height = yy + "px";
        tagImg.style.top = (tagTop + ((sy - yy) / 2)) + "px";
      }
      if(Stop1 && Stop2){
        clearInterval(maxTime);
        tagImg.appendChild(img);
        temp = 0;
        imgOPacity();
      }
    }, 1);
    //浮现效果 伪动画
    function imgOPacity(){
      temp += 10;
      img.style.filter = "alpha(opacity="+temp+")";
      img.style.opacity = temp / 100;
      imgTime = setTimeout(imgOPacity,1);
      if(temp > 100){
        clearTimeout(imgTime);
      }
    }
    //加载关闭标签
    tagImg.appendChild(closeTag);
  }//ImgOK

  //关闭标签显示
  closeTag.style.top = (tagImg.scrollTop + 10) + "px";
  closeTag.style.left = (tagImg.scrollLeft + 10) + "px";

  //关闭操作
  function closes(){
    document.body.removeChild(tagoutside);
    document.body.removeChild(tagImg);
    document.body.removeChild(comments);
    clearTimeout(barShow);
    clearTimeout(imgTime);
    document.onmouseup = null;
    tag = img = tagImg = closeTag = comments = null;
  }
}//ImgShow

//事件绑定部分
var Eventattach = function(){
  if(document.getElementById("workDemo")){
    var workTag = document.getElementById("workDemo");
    var workImg = workTag.getElementsByTagName("img"); 
    var worka = workTag.getElementsByTagName("a");
    for(var i = 0; i < workImg.length; i++){
      workImg[i].onclick = ImgShow;
      //点击后防止页面回到顶部
      worka[i].href = "##";
    }
  }
}

Eventattach();
</script>
</body>
</html>


